<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spectral Simulator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.min.js"></script>
</head>
<body>
    <form method="post" action="{% url 'index' %}">
        {% csrf_token %}
        <label for="Trot_input">Enter rotational temperature in K:</label>
        <input type="number" id="Trot_input" name="Trot_input" required>
        <button type="submit">Submit</button>
    </form>

    {% if result %}
        <div id="chart">
            <svg style="width:100%; height:600px;"></svg>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                var data = [{
                    key: "Spectrum",
                    values: {{ result|safe }} // Ensure result contains pairs of {x: value, y: value}
                }];

                nv.addGraph(function() {
                    var chart = nv.models.lineChart()
                        .useInteractiveGuideline(true);

                    chart.xAxis
                        .axisLabel('Wavelength')
                        .tickFormat(d3.format('.2f'));

                    chart.yAxis
                        .axisLabel('Intensity')
                        
                        .tickFormat(d3.format('d'));

                    d3.select('#chart svg')
                        .datum(data)
                        .call(chart);

                    nv.utils.windowResize(chart.update);

                    return chart;
                });
            });
        </script>
    {% endif %}
</body>
</html>